# 第10章 有限域II：其他性质
*<font color="grey">注：这章就讲了4件事：构建域表和用域表进行运算、找极小多项式、算极小多项式数量、多项式分解</font>*
## 10.1 有限群运算
有很多方法来表示有限域的元素。因为每个有限域$F$是单扩张，有限域的形式为$F=GF(p)(\alpha)$，其中$\alpha\in F$，所以$F$中的元素是$\alpha$的度小于$deg(\alpha)$的多项式。另一个表示有限域元素的方法基于一个事实：$GF(q)^*$是循环群，因此它的元素都是群的生成元的幂。

<font color="grey">*注：回忆定理2.4.1*
$$F(\alpha)=\{f(\alpha)|f(x)\in F[x],deg(f)<deg(p_{\alpha})\}$$
</font>

很明显，当域的元素被表示为多项式时，加法运算更简单；当元素被表示为单个群的生成元（single group primitive element）的幂时，乘法运算更简单。幸运的是，两个方法可以组合在一起，提供了一种有限域运算的有效方式。

**例子10.1.1** 考虑有限域$GF(16)$，它是$GF(2)$的扩张。多项式
$$p(x)=x^4+x+1$$
在$GF(2)$上是不可约的。要证明这个，注意如果$p(x)$是可约的，它必然有一个一次或二次（多项式）因子。但是因为$p(0)
\neq 0$且$p(1)\neq 0$，它没有一次因子（即$x$和$x+1$不是$p(x)$的因子）。要证明$p(x)$没有二次因子，注意在$GF(2)$上只有4个二次多项式，即
$$x^2,x^2+1,x^2+x,x^2+x+1$$
容易验证任意两个二次多项式的乘积不等于$p(x)$.

因此，令$\alpha$为$p(x)$的一个根，我们可以把$GF(16)$中的元素表示为16个度小于等于3的$\alpha$的二进制多项式，如下： \
常数：$0,1$ \
一次：$\alpha,\alpha+1$ \
二次：$\alpha^2,\alpha^2+1,\alpha^2+\alpha,\alpha^2+\alpha+1$ \
三次：$\alpha^3,\alpha^3+1,\alpha^3+\alpha,\alpha^3+\alpha^2,\alpha^3+\alpha+1,\alpha^3+\alpha^2+1,\alpha^3+\alpha^2+\alpha,\alpha^3+\alpha^2+\alpha+1$

$GF(16)$的元素的加法很简单，因为只是多项式的加法，但是乘法需要模$p(\alpha)$，通过$\alpha^4=\alpha+1$。另一方面，观察到
$$\begin{align*}
\alpha^{15}&=(\alpha^5)^3 \\
&=(\alpha\cdot\alpha^4)^3 \\
&=(\alpha\cdot(\alpha+1))^3 \\
&=\alpha^3\cdot(\alpha+1)^3 \\
&=\alpha^3\cdot(\alpha^3+\alpha^2+\alpha+1) \\
&=\alpha^6+\alpha^5+\alpha^4+\alpha^3 \\
&=(\alpha^3+\alpha^2)+(\alpha^2+\alpha)+(\alpha+1)+\alpha^3 \\
&=1
\end{align*}$$
所以$o(\alpha)|15$。因为$\alpha^3\neq 1$且$\alpha^5\neq 1$，得出结论：$\alpha$是群本原元，则
$$GF(16)=\{0,1,\alpha,\cdots,\alpha^{14}\}$$
用这个表示方法，乘法超容易，但是加法很繁琐。

*<font color="grey">注：根据9.4的定义，生成循环群$GF(q)^*$的$GF(q)$的任意元素称为$GF(q)$的一个群本原元。</font>*

我们可以把$GF(16)$的两种表示方法对应起来，通过计算一个表格，显示每个元素$\alpha^k$可以怎么被表示为一个度最高为3的$\alpha$的多项式。使用$\alpha^4=\alpha+1$，有
$$
\begin{align*}
\alpha^4&=\alpha+1 \\
\alpha^5&=\alpha\cdot\alpha^4=\alpha(\alpha+1)=\alpha^2+\alpha \\
\alpha^6&=\alpha\cdot\alpha^5=\alpha^3+\alpha^2 \\
\alpha^7&=\alpha\cdot\alpha^6=\alpha^4+\alpha^3=\alpha^3+\alpha+1 \\
\end{align*}
$$
等等。完整的列表，在表10.1.1中给出，被称为$GF(16)$的**域表**（field table）。按惯例，我们用指数$k$代表$\alpha^k$，用$a_3a_2a_1a_0$代表多项式$a_3\alpha^3+a_2\alpha^2+a_1\alpha+a_0$。

表10.1.1
|$k$|$a_3a_2a_1a_0$|
|:-:|:-:|
|0|0001|
|1|0010|
|2|0100|
|3|1000|
|4|0011|
|5|0110|
|6|1100|
|7|1011|
|8|0101|
|9|1010|
|10|0111|
|11|1110|
|12|1111|
|13|1101|
|14|1001|

用这个表格做计算非常直接；例如，
$$\begin{align*}
(\alpha^8+\alpha^4+1)(\alpha^3+\alpha)&=(0101+0011+0001)(1000+0010) \\
&=(0111)(1010) \\
&=\alpha^{10}\cdot\alpha^9=\alpha^{19}=\alpha^4=\alpha+1
\end{align*}$$
因此，在有限域上做运算的关键是有一个群的本原元，和它的极小（本原）多项式。一般来说，本原多项式不好找。有很多方法在特定案例中取得了某种成功，我们在11.2节的末尾提到了其中一种方法。幸运的是，本原多项式的巨大表格和域表已经构建好了。

*<font color="grey">问题：这段不知道在说什么，大概是说要找本原多项式吧</font>*

使用本原多项式$p(x)$和$GF(16)$的域表来计算每个$GF(16)$元素在$GF(2)$上的极小多项式。我们从计算共轭元素集合开始，使用定理9.6.1和$\alpha^{16}=\alpha$，得到 \
$\alpha$的共轭元：$\alpha,\alpha^2,\alpha^4,\alpha^8$ \
$\alpha^3$的共轭元：$\alpha^3,\alpha^6,\alpha^{12},\alpha^{24}=\alpha^9$ \
$\alpha^5$的共轭元：$\alpha^5,\alpha^{10}$ \
$\alpha^7$的共轭元：$\alpha^7,\alpha^{14},\alpha^{28}=\alpha^{13},\alpha^{56}=\alpha^{11}$ \

*<font color="grey">注1：根据定理9.6.1，有限域$GF(q)$，不可约多项式$p(x)$的度为$d$，在扩域中有一个根为$\alpha$，则分裂域中$p(x)$的根为$\alpha,\alpha^q,\alpha^{q^2},\cdots,\alpha^{q^{d-1}}$。所以这里通过$x\rightarrow x^2$寻找共轭元。</font>*

*<font color="grey">注2：为什么选择指数1,3,5,7计算共轭元？因为共轭的元素形成了集合，目标是找到所有集合和内容。算完$\alpha$以后还有$\alpha^3$不在集合里，算完$\alpha^3$还有$\alpha^5$，算完$\alpha^7$以后所有元素都找过了，所以正好是选了指数1,3,5,7。</font>*

令$m_k(x)$为$\alpha^k$的极小多项式，我们有，比如
$$m_5(x)=m_{10}(x)=(x-\alpha^5)(x-\alpha^{10})=x^2-(\alpha^5+\alpha^{10})x+\alpha^{15}$$
$GF(16)$的域表给出
$$\alpha^5+\alpha^{10}=(0110)+(0111)=(0001)=\alpha^0=1$$
因为$\alpha^{15}=1$，所以
$$m_5(x)=m_{10}(x)=x^2+x+1$$
其他极小多项式也能用类似的方式计算出来，完整列表为
$$
m_0(x)=x+1 \\
m_1(x)=m_2(x)=m_4(x)=m_8(x)=x^4+x+1 \\
m_3(x)=m_6(x)=m_9(x)=m_{12}(x)=x^4+x^3+x^2+x+1 \\
m_5(x)=m_{10}(x)=x^2+x+1 \\
m_7(x)=m_{11}(x)=m_{13}(x)=m_{14}(x)=x^4+x^3+1 \\
$$
能够对形式$x^n-1$分解多项式因式在有限域理论的很多应用中是很重要的。特别对于编码理论。因为$x^{15}-1$在$GF(2)$上的根就是$GF(16)^*$的元素，我们有
$$x^{15}-1=m_0(x)m_1(x)m_3(x)m_5(x)m_7(x)$$
当然，为了得到这个分解，我们在分裂域$GF(16)$中计算。让我们看看一个在$\mathbb{Z}_p=GF(p)$上分解多项式的方法，它不需要在$\mathbb{Z}_p$的扩域中计算。

### 在$\mathbb{Z}_p$上因式分解：Berklekamp算法
Berlekamp算法是一种在$\mathbb{Z}_p$上分解多项式的算法。假设$f(x)$是$\mathbb{Z}_p$上的一个$d$次多项式。首先让我们证明我们可以将$f(x)$的分解问题简化为一个没有重复因子的多项式的分解问题。

我们知道$f(x)$有重复的因子当且仅当$f(x)$和$f'(x)$有公因子。写作
$$f(x)=\gcd(f(x),f'(x))\cdot\frac{f(x)}{\gcd(f(x),f'(x))}$$
设$d(x)=\gcd(f(x),f'(x))$。如果$d(x)=1$则$f(x)$没有重复因子。如果$d(x)=f(x)$则$f'(x)=0$，因此
$$f(x)=h(x^p)=(h(x))^p$$
则我们可以分解$h(x)$（或重复这个步骤）。这两种情况以外，$d(x)$是一个非常多项式，度小于$f(x)$，且$f(x)/d(x)$没有重复因子。因此，我们可以分别考虑多项式$d(x)$和$f(x)/d(x)$。对于前者，我们可以重复上述讨论，直到分解问题简化为没有重复因子的多项式的分解问题。

所以让我们假设$f(x)$是不同的不可分因子的乘积。（实际上，我们将介绍的的分解算法没有这条关于$f(x)$的限制条件，但是我们将展示的不可约因子数量的公式有这个限制条件。）

假设我们能找到一个非常的，度小于$d$的多项式$g(x)$，使得
$$f(x)\mid g(x)^p-g(x)$$
因为$\mathbb{Z}_p=\{0,1,\ldots,p-1\}$是$x^p-x$的根的集合，我们有
$$x^p-x=x(x-1)\cdots(x-p+1)$$
因此
$$g(x)^p-g(x)=g(x)(g(x)-1)\cdots(g(x)-p+1)$$
同样，在一般情况下，如果$a\mid b_1\cdots b_k$，其中$b_1,\cdots,b_k$两两互素，则
$$a=\gcd(a,b_1)\cdots\gcd(a,b_k)$$
因此，因为多项式$g(x)-k$两两互素，其中$k=0,\cdots,p-1$，我们有
$$f=\gcd(f,g)\gcd(f,g-1)\cdots\gcd(f,g-p+1)$$
注意每个因子的度最多为$\deg(g)<d$，因此这个$f(x)$的分解是非平凡的。也注意欧几里得算法可以用于在分解中找到gcd，因此如果我们能找到这样一个多项式$g(x)$，我们就有一个找到$f(x)$的非平凡因式分解的算法。

使$f(x)\mid g(x)^p-g(x)$成立的多项式$g(x)$被称为$f$-**简化多项式**（reducing polynomial）。我们对非常的，度小于$f(x)$的度的$f$-简化多项式很感兴趣，因为这些多项式可以用于分解$f(x)$。

要找到这样一个$f$-简化多项式$g(x)$，写作
$$g(x)=g_0+g_1x+\cdots+g_{d-1}x^{d-1}$$
因为我们在特征为$p$的域上工作，因为在模$p$时$g_k^p=g_k$，从而$g(x)^p=g(x^p)$，因此
$$g(x)^p-g(x)=g(x^p)-g(x)=\sum_{i=0}^{d-1}g_i(x^{ip}-x^i)$$
现在假设$x^{ip}=a_i(x)f(x)+r_i(x)$，其中$\deg(r_i)<d$。则$g(x)^p-g(x)$能被$f(x)$整除当且仅当
$$f(x)\mid \sum_{i=0}^{d-1}g_i(r_i(x)-x^i)$$
但因为右边的求和的度小于$f(x)$的度，这等价于
$$\sum_{i=0}^{d-1}g_i(r_i(x)-x^i)=0$$
这等价于一个线性方程组。用矩阵形式表达，假设$r_{i}(x)=r_{i,0}+r_{i,1}x+\cdots+r_{i,d-1}x^{d-1}$。则上文等式等价于
$$\sum_{i=0}^{d-1}g_i(r_{i,j}-\delta_{i,j})=0$$
对于$j=0,\cdots,d-1$。用矩阵表达，如果$M=(r_{i,j})$，$I_d=(\delta_{i,j})$则
$$G=\left[\begin{array}{ccc}g_0&\cdots&g_{d-1}\end{array}\right]$$
是$g(x)$系数的行矩阵，则线性方程组为
$$G(M-I_d)=0$$

**例子10.1.1** 考虑$\mathbb{Z}_2$上的多项式
$$f(x)=1+x+x^2+x^3+x^4+x^5+x^6$$
首先我们找多项式$r_i(x)$，通过用$x^{2i}$除以$f(x)$，得到
$$\begin{aligned}
&r_{0}(x) =1  \\
&r_{1}(x) =x^{2}  \\
&r_{2}(x) =x^4  \\
&r_{3}(x) =1+x+x^2+x^3+x^4+x^5  \\
&r_{4}(x) =x  \\
&r_{5}(x) =x^{3} 
\end{aligned}$$
因此，
$$M-I_6=\begin{bmatrix}0&0&0&0&0&0\\0&1&1&0&0&0\\0&0&1&0&1&0\\1&1&1&0&1&1\\0&1&0&0&1&0\\0&0&0&1&0&1\end{bmatrix}$$
我们的线性方程组为
$$\begin{aligned}
g_{3}& =0  \\
g_{1}+g_{3}+g_{4}& =0  \\
g_{1}+g_{2}+g_{3}& =0  \\
g_{5}& =0  \\
g_{2}+g_{3}+g_{4}& =0  \\
g_{3}+g_{5}& =0 
\end{aligned}$$
解为
$$g_0\text{任意};g_1=g_2=g_4;g_3=g_5=0$$
唯一非常解为
$$g(x)=g_0+x+x^2+x^4$$
其中$g_0=0,1$。从而
$$g(x)^2-g(x)=x^8+x=(x^2+x)f(x)$$
因此，用欧几里得算法计算gcd，我们得到分解
$$\begin{aligned}
f(x)& =\gcd(f(x),g(x))\gcd(f(x),g(x)-1)  \\
&=\gcd(f(x),x+x^2+x^4)\gcd(f(x),1+x+x^2+x^4) \\
&=(1+x+x^3)(1+x^2+x^3)
\end{aligned}$$
$\Box$

*<font color="grey">注：对于不可约多项式，$g(x)$为常数多项式（会有其他情况吗？）</font>*

*<font color="grey">省略内容：不可约因式的数量</font>*